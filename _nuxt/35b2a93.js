(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{540:function(t,e,n){"use strict";n.r(e);n(312),n(65);var r=n(27),o=n(36),c=n(42),l=n(35),f=n(28),d=n(13),m=n(181);function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(f.a)(t);if(e){var o=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var h=function(t,e,n,desc){var r,o=arguments.length,c=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(d.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(c=(o<3?r(c):o>3?r(e,n,c):r(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},y=function(t){Object(c.a)(n,t);var e=v(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"getTextContent",value:function(element){var text="";if(element.text&&(text+=element.text.trim()),element.elements)for(var i=0;i<element.elements.length;i++)text+=this.getTextContent(element.elements[i]);return text.trim()}},{key:"canvas",get:function(){return this.$store.getters.canvas},set:function(t){this.$store.commit("setCanvas",t)}},{key:"facs",get:function(){return this.$store.getters.getFacs},set:function(t){this.$store.commit("setFacs",t)}}]),n}(m.Vue);h([Object(m.Prop)({})],y.prototype,"element",void 0);var w=y=h([Object(m.Component)({components:{TeiElement:$},name:"TeiElement"})],y),x=(n(621),n(103)),_=n(143),j=n.n(_),O=n(219),k=n(543),component=Object(x.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.element.name||"span",{tag:"component"},[("tei-date"==t.element.name||"tei-time"==t.element.name)&&t.element.attributes&&t.element.attributes.when?[n("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("span",t._g(t._b({},"span",o,!1),r),[t._v(t._s(t.element.elements[0].text))])]}}],null,!1,1766447786)},[t._v(" "),n("span",[t._v(t._s(t.element.attributes.when))])])]:"tei-persname"!=t.element.name&&"tei-placename"!=t.element.name||!t.element.attributes?"text"==t.element.type?[t._v("\n    "+t._s(t.element.text)+"\n  ")]:["tei-pb"==t.element.name&&t.element.attributes&&t.element.attributes.corresp?[n("v-icon",{staticClass:"ma-1",attrs:{color:"purple"},on:{click:function(e){t.canvas=t.facs[t.element.attributes.corresp.replace("#","")]}}},[t._v("mdi-image")]),t._v(" "),n("span",{staticClass:"ma-1",staticStyle:{color:"grey"}},[t._v("[Page @"+t._s(t.element.attributes.corresp)+"]")])]:t._e(),t._v(" "),t._l(t.element.elements,(function(t,e){return n("TeiElement",{key:e,attrs:{element:t}})}))]:[n("a",{staticStyle:{"text-decoration":"none"},attrs:{target:"_blank",href:"https://shibusawa-dlab.github.io/lab1/entity/"+("tei-persname"==t.element.name?"agential":"spatial")+"/"+t.getTextContent(t.element)}},t._l(t.element.elements,(function(t,e){return n("TeiElement",{key:e,attrs:{element:t}})})),1)]],2)}),[],!1,null,"790cfa5a",null),$=e.default=component.exports;j()(component,{TeiElement:n(540).default}),j()(component,{VIcon:O.a,VTooltip:k.a})},574:function(t,e,n){var content=n(622);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(18).default)("38e7a787",content,!0,{sourceMap:!1})},583:function(t,e,n){var content=n(639);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(18).default)("35fb34e0",content,!0,{sourceMap:!1})},584:function(t,e,n){var content=n(641);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(18).default)("36cd220e",content,!0,{sourceMap:!1})},621:function(t,e,n){"use strict";n(574)},622:function(t,e,n){(e=n(17)(!1)).push([t.i,"tei-persName[data-v-790cfa5a]{background-color:#ffccbc}tei-placeName[data-v-790cfa5a]{background-color:#c8e6c9}tei-date[data-v-790cfa5a]{background-color:#bbdefb}tei-time[data-v-790cfa5a]{background-color:#fff9c4}tei-head[data-v-790cfa5a]{margin:20px;font-size:large!important;font-weight:700}",""]),t.exports=e},627:function(t,e){},629:function(t,e){},638:function(t,e,n){"use strict";n(583)},639:function(t,e,n){(e=n(17)(!1)).push([t.i,"tei-encodingdesc,tei-publicationstmt,tei-publicationstmt>*,tei-sourcedesc{display:block!important}",""]),t.exports=e},640:function(t,e,n){"use strict";n(584)},641:function(t,e,n){(e=n(17)(!1)).push([t.i,".scroll{overflow-y:auto}.vertical{-ms-writing-mode:tb-rl;writing-mode:vertical-rl}",""]),t.exports=e},664:function(t,e,n){"use strict";n.r(e);n(50),n(14),n(68),n(32),n(63);var r=n(650),o=n(573),c=n.n(o),l=(n(312),n(27)),f=n(36),d=n(42),m=n(35),v=n(28),h=n(13),y=n(181);function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(v.a)(t);if(e){var o=Object(v.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}var x=function(t,e,n,desc){var r,o=arguments.length,c=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(h.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(c=(o<3?r(c):o>3?r(e,n,c):r(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},_=function(t){Object(d.a)(n,t);var e=w(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(f.a)(n,[{key:"id",get:function(){return this.$store.getters.getId},set:function(t){this.$store.commit("setId",t)}}]),n}(y.Vue);x([Object(y.Prop)()],_.prototype,"items",void 0);var j=_=x([Object(y.Component)({})],_),O=n(103),k=n(143),$=n.n(k),R=n(222),C=n(224),T=n(134),V=n(95),component=Object(O.a)(j,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-list",[n("v-list-item",{staticClass:"mt-5"},[n("v-list-item-title",[n("h3",[t._v(t._s(t.$t("コンテンツ")))])])],1),t._v(" "),t._l(t.items,(function(e,r){return n("v-list-group",{key:r,attrs:{"no-action":"","sub-group":""},scopedSlots:t._u([{key:"activator",fn:function(){return[n("v-list-item-content",{on:{click:function(n){t.id=e.id}}},[n("v-list-item-title",[t._v(t._s(e.label))])],1)]},proxy:!0}],null,!0)},[t._v(" "),t._l(e.children,(function(e,r){return[e.label?n("v-list-item",{key:r,on:{click:function(n){t.id=e.id}}},[n("v-list-item-title",[t._v(t._s(e.label))])],1):t._e()]}))],2)}))],2)}),[],!1,null,null,null),S=component.exports;$()(component,{VList:R.a,VListGroup:C.a,VListItem:T.a,VListItemContent:V.a,VListItemTitle:V.b});var E=n(540);function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(v.a)(t);if(e){var o=Object(v.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}var I=function(t,e,n,desc){var r,o=arguments.length,c=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(h.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(c=(o<3?r(c):o>3?r(e,n,c):r(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},M=n(575),N=n(573),D=function(t){Object(d.a)(n,t);var e=P(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(f.a)(n,[{key:"bbb",value:function(data){if(!data)return{};var t=M.xml2json(data.outerHTML,{compact:!1,spaces:4});return JSON.parse(t).elements[0]}},{key:"xml",get:function(){return this.$store.getters.getXml},set:function(t){this.$store.commit("setXml",t)}},{key:"metadata",get:function(){var t=this.xml;if(!t)return"";var header=t.querySelector("tei-teiheader");return header?(new XMLSerializer).serializeToString(header):""}},{key:"arr",get:function(){return N(N(this.xml).find("tei-teiheader")).children()}}]),n}(y.Vue),L=D=I([Object(y.Component)({components:{TeiElement:E.default}})],D),z=(n(638),Object(O.a)(L,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pa-5"},t._l(t.arr,(function(e,r){return n("TeiElement",{key:r,staticClass:"my-5",attrs:{element:t.bbb(e)}})})),1)}),[],!1,null,null,null)),B=z.exports;installComponents(z,{TeiElement:n(540).default});var H=n(575),X={components:{Menu:S,Metadata:B,TeiElement:E.default},data:function(){return{baseUrl:"https://shibusawa-dlab.github.io/lab1",siteName:"伝記資料TEI共同研究",github:"https://github.com/shibusawa-dlab/lab1",loading:!1,width:window.innerWidth,height:window.innerHeight,drawer:!1,drawer2:!1,manifest:null,index:0,divs:[],ids:{},ids2:{},divs2:[],items:[]}},head:function(){return{titleTemplate:null,title:this.$t(this.siteName)}},computed:{style:{get:function(){return this.$store.getters.getStyle},set:function(t){this.$store.commit("setStyle",t)}},xml:{get:function(){return this.$store.getters.getXml},set:function(t){this.$store.commit("setXml",t)}},facs:{get:function(){return this.$store.getters.getFacs},set:function(t){this.$store.commit("setFacs",t)}},canvas:{get:function(){return this.$store.getters.getCanvas},set:function(t){this.$store.commit("setCanvas",t)}},id:{get:function(){return this.$store.getters.getId},set:function(t){this.$store.commit("setId",t)}}},watch:{id:function(t){t&&(this.$router.push(this.localePath({name:"viewer-id",params:{id:this.$route.params.id},query:{id:t}}),(function(){}),(function(){})),this.index=this.ids[t])},index:function(t){this.id=this.ids2[t],this.canvas=this.canvases[t]}},mounted:function(){this.loading=!0,window.addEventListener("resize",this.handleResize);var t=this.$route.params.id,e=this.$route.query.u||this.baseUrl+"/data/"+t+".xml",n=new r.a,o=this.$route.query.id,l=this;n.getHTML5(e,(function(data){console.log("downloaded."),l.xml=data;for(var t=c()(c()(data).find("tei-text")[0]).find("tei-text"),e=[],n={},r={},f=[],d=[],m=0,v=0;v<t.length;v++){var text=t[v],label="",h=c()(text).find("tei-head");h.length>0&&(label=h[0].textContent);var y=m;c()(text).attr("xml:id")&&(y=c()(text).attr("xml:id"));for(var w=c()(text).find("tei-div"),x=[],i=0;i<w.length;i++){var div=w[i];x.push(div),c()(div).remove()}x.unshift(text);var _=[];d.push({label:label,id:y,children:_});for(var j=c()(data).find("tei-source"),O={},k=0;k<j.length;k++){var source=j[k];O[c()(source).attr("xml:id")]=c()(source).attr("source")}l.facs=O;for(var $=O[Object.keys(O)[0]],R=0;R<x.length;R++){var C=x[R];e.push(C);var T=c()(C).find("tei-pb"),canvas="";if(0===T.length)canvas=$;else{var V=T[0],S=c()(V).attr("n");canvas=O["pageB"+(Number(S.replace("B",""))-1)];var E=T[T.length-1];$=O[c()(E).attr("corresp").replace("#","")]}if(f.push(canvas),c()(C).attr("xml:id")?(n[c()(C).attr("xml:id")]=m,r[m]=c()(C).attr("xml:id")):(n[m]=m,r[m]=m),o===r[m]&&(l.index=m),0!==R){var P="",I=c()(C).find("tei-head");I.length>0&&(P=I[0].textContent),_.push({label:P,id:r[m]})}m+=1}}l.items=d,l.divs=[],l.divs2=e,l.ids=n,l.ids2=r,l.canvases=f;var M=c()(data).find("tei-facsimile").attr("source");l.manifest=M,l.loading=!1,console.log("processed.")}))},methods:{handleResize:function(){this.width=window.innerWidth,this.height=window.innerHeight},bbb:function(data){if(!data)return{};var t=H.xml2json(data.outerHTML,{compact:!1,spaces:4});return JSON.parse(t).elements[0]}}},F=(n(640),n(514)),J=n(508),U=n(238),A=n(221),W=n(533),G=n(515),K=n(219),Q=n(513),Y=n(218),Z=n(534),tt=n(512),et=n(543),nt=Object(O.a)(X,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.loading?[n("div",{staticClass:"pa-10 text-center"},[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1)]:[n("v-navigation-drawer",{staticStyle:{"z-index":"100000"},attrs:{app:"",temporary:!1,width:384},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("Menu",{attrs:{id:t.$route.query.id,items:t.items}})],1),t._v(" "),n("v-navigation-drawer",{attrs:{app:"",temporary:!0,right:"",width:512},model:{value:t.drawer2,callback:function(e){t.drawer2=e},expression:"drawer2"}},[n("Metadata")],1),t._v(" "),n("v-app-bar",{attrs:{flat:""}},[n("v-btn",{attrs:{icon:""},on:{click:function(e){t.drawer=!t.drawer}}},[n("v-icon",[t._v("mdi-view-list")])],1),t._v(" "),n("v-spacer"),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.index!=t.divs2.length-1,expression:"index != divs2.length - 1"}],staticClass:"mx-1",attrs:{fab:"",dark:"",small:""},on:{click:function(e){t.index+=1}}},r),[n("v-icon",{attrs:{dark:""}},[t._v(" mdi-menu-left ")])],1)]}}])},[t._v(" "),n("span",[t._v(t._s(t.$t("next")))])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:0!=t.index,expression:"index != 0"}],staticClass:"mx-1",attrs:{fab:"",dark:"",small:""},on:{click:function(e){t.index-=1}}},r),[n("v-icon",{attrs:{dark:""}},[t._v(" mdi-menu-right ")])],1)]}}])},[t._v(" "),n("span",[t._v(t._s(t.$t("previous")))])]),t._v(" "),n("v-spacer"),t._v(" "),n("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.drawer2=!t.drawer2}}})],1),t._v(" "),n("v-container",{attrs:{fluid:""}},[n("v-row",{staticClass:"mt-2"},[n("v-col",{attrs:{cols:"12",sm:t.manifest?6:12}},[n("v-card",{staticClass:"scroll vertical",style:"height: "+.8*t.height+"px; width: "+(t.manifest?t.width/2:t.width)+"px;",attrs:{id:"container",flat:"",outlined:""}},[n("div",{staticClass:"pa-4 px-5"},[t.divs2.length>0?n("TeiElement",{attrs:{element:t.bbb(t.divs2[t.index])}}):t._e()],1)])],1),t._v(" "),n("v-col",{attrs:{cols:"12",sm:t.manifest?6:12}},[t.manifest?n("iframe",{style:"height: "+.8*t.height+"px;",attrs:{src:t.baseUrl+"/curation/?manifest="+t.manifest+"&canvas="+t.canvas,width:"100%",allowfullscreen:"allowfullscreen",frameborder:"0"}}):t._e()])],1)],1)]],2)}),[],!1,null,null,null);e.default=nt.exports;$()(nt,{TeiElement:n(540).default}),$()(nt,{VAppBar:F.a,VAppBarNavIcon:J.a,VBtn:U.a,VCard:A.a,VCol:W.a,VContainer:G.a,VIcon:K.a,VNavigationDrawer:Q.a,VProgressCircular:Y.a,VRow:Z.a,VSpacer:tt.a,VTooltip:et.a})}}]);